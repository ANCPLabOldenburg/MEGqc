<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=5,IE=9" ><![endif]-->
<!DOCTYPE html>
<html>
<head>
<title>_ECG_UML2.5 new</title>
<meta charset="utf-8"/>
</head>
<body><div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;Electron\&quot; modified=\&quot;2023-06-29T14:16:56.514Z\&quot; agent=\&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.5.1 Chrome/112.0.5615.204 Electron/24.6.0 Safari/537.36\&quot; etag=\&quot;2fyYq-ULT3lZtMtXFDsp\&quot; version=\&quot;21.5.1\&quot; type=\&quot;device\&quot;&gt;\n  &lt;diagram name=\&quot;Page-1\&quot; id=\&quot;929967ad-93f9-6ef4-fab6-5d389245f69c\&quot;&gt;\n    &lt;mxGraphModel dx=\&quot;3985\&quot; dy=\&quot;4485\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;0\&quot; pageScale=\&quot;1.5\&quot; pageWidth=\&quot;827\&quot; pageHeight=\&quot;1169\&quot; background=\&quot;none\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;\n      &lt;root&gt;\n        &lt;mxCell id=\&quot;0\&quot; style=\&quot;;html=1;\&quot; /&gt;\n        &lt;mxCell id=\&quot;1\&quot; style=\&quot;;html=1;\&quot; parent=\&quot;0\&quot; /&gt;\n        &lt;mxCell id=\&quot;1672d66443f91eb5-23\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-weight: normal;&amp;quot;&amp;gt;Detect hear beat artifacts&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;i&amp;gt;ECG_meg_qc()&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;strokeColor=none;fillColor=none;html=1;fontSize=28;fontStyle=1;verticalAlign=middle;align=center;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1184\&quot; y=\&quot;-2620\&quot; width=\&quot;1110\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;qlgW9oU40mQZMEhXMN03-3\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-1\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-9\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-900\&quot; y=\&quot;-2359\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-1\&quot; value=\&quot;Input:&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Raw data,&amp;lt;br&amp;gt;Config parameters\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-960\&quot; y=\&quot;-2459\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-12\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-2\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-2\&quot; value=\&quot;\&quot; style=\&quot;ellipse;fillColor=strokeColor;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-650\&quot; y=\&quot;-2499\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-7\&quot; value=\&quot;\&quot; style=\&quot;group;flipV=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-765\&quot; y=\&quot;-2404\&quot; width=\&quot;250\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-8\&quot; value=\&quot;Pick ECG channels&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;mne.pick_types(ecg=True)&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-7\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;10\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-9\&quot; value=\&quot;pinIn 2\&quot; style=\&quot;fontStyle=0;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;flipH=0;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-7\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;25\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-10\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-7\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;115\&quot; y=\&quot;80\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-124\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-117\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-123\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-125\&quot; value=\&quot;True\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-124\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-0.1278\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-4\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;jumpStyle=arc;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-117\&quot; target=\&quot;jzh1gqENJoQ-7TW8aTZ5-3\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-5\&quot; value=\&quot;False\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;jzh1gqENJoQ-7TW8aTZ5-4\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-0.0661\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-117\&quot; value=\&quot;&amp;lt;b style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Mean overall epoch&amp;lt;/b&amp;gt;&amp;amp;nbsp;has&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;expected&amp;lt;/font&amp;gt;&amp;amp;nbsp;&amp;lt;font style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;shape (prominent peak at specific time point)?&amp;lt;/font&amp;gt;\&quot; style=\&quot;rhombus;html=1;fontSize=12;whiteSpace=wrap;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1137\&quot; y=\&quot;-730\&quot; width=\&quot;200\&quot; height=\&quot;117.5\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-118\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=0.25;exitY=1;exitDx=0;exitDy=0;jumpStyle=arc;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-78\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-117\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-988\&quot; y=\&quot;-761\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-1042\&quot; y=\&quot;-880\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1200\&quot; y=\&quot;-880\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1200\&quot; y=\&quot;-671\&quot; /&gt;\n            &lt;/Array&gt;\n            &lt;mxPoint x=\&quot;-1120\&quot; y=\&quot;-541\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-120\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1117\&quot; y=\&quot;-430\&quot; width=\&quot;397\&quot; height=\&quot;290\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-121\&quot; value=\&quot;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Find the channels with the&amp;amp;nbsp;peak&amp;lt;span style=&amp;quot;border-color: var(--border-color); background-color: initial;&amp;quot;&amp;gt;&amp;amp;nbsp;of ECG epoch higher than the threshold.&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;border-color: var(--border-color); background-color: initial;&amp;quot;&amp;gt;Threshold = peak magnitude of &amp;lt;br&amp;gt;&amp;lt;b&amp;gt;mean overall&amp;amp;nbsp; epoch&amp;lt;/b&amp;gt;&amp;amp;nbsp; * multiplier&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;detect_channels_above_norm()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-120\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-43\&quot; y=\&quot;-119\&quot; width=\&quot;245.99999999999997\&quot; height=\&quot;88\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-122\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-120\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;65.62499999999999\&quot; y=\&quot;-30.999999999999986\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-123\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-120\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;65.62499999999999\&quot; y=\&quot;-129\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-130\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-122\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-129\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-1033\&quot; y=\&quot;-450\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;-1033\&quot; y=\&quot;-410\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-1029\&quot; y=\&quot;-431\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1028\&quot; y=\&quot;-410\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-132\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1156\&quot; y=\&quot;-390\&quot; width=\&quot;250\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-126\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-132\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry width=\&quot;240\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-127\&quot; value=\&quot;&amp;lt;p style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Plot all&amp;lt;b style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;amp;nbsp;affected&amp;lt;/b&amp;gt;&amp;amp;nbsp;channels + threshold&amp;lt;br&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;Plot&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; border-color: var(--border-color);&amp;quot;&amp;gt;not affected&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;channels + threshold&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;plot_affected_channels()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-126\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;10\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-129\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-126\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-131\&quot; value=\&quot;pinOut 1\&quot; style=\&quot;fontStyle=0;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-132\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;240\&quot; y=\&quot;35.00000000000023\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-162\&quot; value=\&quot;3\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-870\&quot; y=\&quot;-355\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-163\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-131\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-162\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;zNMVAwUSSOP5G73fzrCB-4\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-122\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-610\&quot; y=\&quot;-190\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-1044\&quot; y=\&quot;-440\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1188\&quot; y=\&quot;-440\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1188\&quot; y=\&quot;-220\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-610\&quot; y=\&quot;-220\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-610\&quot; y=\&quot;-190\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;zNMVAwUSSOP5G73fzrCB-7\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-728\&quot; y=\&quot;-190\&quot; width=\&quot;260\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-164\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;zNMVAwUSSOP5G73fzrCB-7\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;10\&quot; width=\&quot;250\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-165\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-164\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry width=\&quot;240\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-166\&quot; value=\&quot;&amp;lt;p style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Save info about the level of ECG&amp;amp;nbsp;contamination for each channel&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;in dictionary&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;i&amp;gt;&amp;lt;b&amp;gt;make_simple_metric_ecg()&amp;lt;/b&amp;gt;&amp;lt;/i&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-165\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;10\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-78\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-165\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;102\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-168\&quot; value=\&quot;pinOut 1\&quot; style=\&quot;fontStyle=0;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-164\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;240\&quot; y=\&quot;35.00000000000023\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;zNMVAwUSSOP5G73fzrCB-8\&quot; value=\&quot;Output:&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;List of QC derivatives (figs)&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Dict as Simple metric&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Str about ECG artifacts\&quot; style=\&quot;html=1;dashed=0;fontFamily=Helvetica;fontSize=12;fontColor=rgb(0, 0, 0);align=center;strokeColor=rgb(0, 0, 0);fillColor=rgb(255, 255, 255);\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-60\&quot; y=\&quot;-180\&quot; width=\&quot;198\&quot; height=\&quot;81\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;zNMVAwUSSOP5G73fzrCB-9\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-168\&quot; target=\&quot;zNMVAwUSSOP5G73fzrCB-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-43\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1119\&quot; y=\&quot;-1160\&quot; width=\&quot;409\&quot; height=\&quot;1020\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-44\&quot; value=\&quot;For some channels correct the orientation of electrodes relative to the magnetic field:&amp;amp;nbsp;&amp;amp;nbsp;flip the average epoch to the positive side&amp;lt;br&amp;gt;for each channel&amp;amp;nbsp;&amp;lt;span style=&amp;quot;border-color: var(--border-color); background-color: initial;&amp;quot;&amp;gt;.&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;flip_channels()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;&amp;amp;nbsp;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-43\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-42\&quot; y=\&quot;-118\&quot; width=\&quot;248\&quot; height=\&quot;96\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-45\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-43\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;66.49999999999999\&quot; y=\&quot;-22\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-46\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-43\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;66.49999999999999\&quot; y=\&quot;-128\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-93\&quot; value=\&quot;1\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-43\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;379\&quot; y=\&quot;376\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-57\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-45\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-55\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-108\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-1038.4444444444448\&quot; y=\&quot;-891\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;-1037\&quot; y=\&quot;-850\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-1037\&quot; y=\&quot;-891\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-109\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;jumpStyle=arc;exitX=0.25;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-54\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-116\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-1072\&quot; y=\&quot;-1030\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-1046\&quot; y=\&quot;-1020\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1180\&quot; y=\&quot;-1020\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1180\&quot; y=\&quot;-800\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-110\&quot; value=\&quot;2\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-877\&quot; y=\&quot;-815\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-111\&quot; value=\&quot;\&quot; style=\&quot;endArrow=open;html=1;rounded=0;align=center;verticalAlign=top;endFill=0;labelBackgroundColor=none;endSize=6;exitX=1;exitY=0.5;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-115\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-110\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-890\&quot; y=\&quot;-800\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-116\&quot; value=\&quot;pinOut 1\&quot; style=\&quot;fontStyle=0;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1165\&quot; y=\&quot;-814.9999999999998\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-2\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;jumpStyle=arc;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-102\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-117\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Nbf0Tub4fTZDGGXtQ6uE-23\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontColor=#000000;\&quot; parent=\&quot;1\&quot; source=\&quot;jzh1gqENJoQ-7TW8aTZ5-6\&quot; target=\&quot;zNMVAwUSSOP5G73fzrCB-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;33\&quot; y=\&quot;-180\&quot; /&gt;\n              &lt;mxPoint x=\&quot;33\&quot; y=\&quot;-180\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-6\&quot; value=\&quot;2\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;4\&quot; y=\&quot;-240\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-86\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.636;entryY=0.012;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;61\&quot; y=\&quot;-210\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;62.927999999999884\&quot; y=\&quot;-179.02800000000025\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-7\&quot; value=\&quot;3\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;49\&quot; y=\&quot;-240\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-13\&quot; value=\&quot;Output:&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;List of QC derivatives (fig)&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Empty dict as Simple metric&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Str about no ECG artifacts detected\&quot; style=\&quot;html=1;dashed=0;fontFamily=Helvetica;fontSize=12;fontColor=rgb(0, 0, 0);align=center;strokeColor=rgb(0, 0, 0);fillColor=rgb(255, 255, 255);\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-780\&quot; y=\&quot;-711.75\&quot; width=\&quot;198\&quot; height=\&quot;81\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-14\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;jumpStyle=arc;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;jzh1gqENJoQ-7TW8aTZ5-3\&quot; target=\&quot;jzh1gqENJoQ-7TW8aTZ5-13\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-16\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;jumpStyle=arc;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.707;entryY=0.022;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;jzh1gqENJoQ-7TW8aTZ5-15\&quot; target=\&quot;jzh1gqENJoQ-7TW8aTZ5-13\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-15\&quot; value=\&quot;2\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-655\&quot; y=\&quot;-785\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-77\&quot; value=\&quot;&amp;lt;font style=&amp;quot;border-color: var(--border-color); background-color: initial;&amp;quot;&amp;gt;For&amp;amp;nbsp;&amp;lt;b style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;mean overall epoch&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;detect peaks and evaluate if the epoch has an expected wave shape based on number and location of peaks.&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;find_peaks_and_detect_Rwave()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1158\&quot; y=\&quot;-989\&quot; width=\&quot;245.99999999999997\&quot; height=\&quot;88\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-78\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1049.375\&quot; y=\&quot;-901\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-79\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1049.375\&quot; y=\&quot;-999\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-80\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-54\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-79\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-1034\&quot; y=\&quot;-1030\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1034\&quot; y=\&quot;-1030\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-53\&quot; value=\&quot;&amp;lt;font style=&amp;quot;border-color: var(--border-color); background-color: initial; text-align: left;&amp;quot;&amp;gt;Calculate &amp;lt;b&amp;gt;mean overall epoch&amp;lt;/b&amp;gt; averaged over&amp;lt;/font&amp;gt;&amp;amp;nbsp;all channels&amp;amp;nbsp;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;i style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;np.mean()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1157\&quot; y=\&quot;-1126\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-54\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1052\&quot; y=\&quot;-1046\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-55\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1052\&quot; y=\&quot;-1136\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;jzh1gqENJoQ-7TW8aTZ5-3\&quot; value=\&quot;\&quot; style=\&quot;shape=sumEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;backgroundOutline=1;fontFamily=Courier New;fontSize=12;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-873\&quot; y=\&quot;-686\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-101\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1113\&quot; y=\&quot;-720\&quot; width=\&quot;395\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-102\&quot; value=\&quot;Plot&amp;amp;nbsp;&amp;lt;b style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;mean overall&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;amp;nbsp;&amp;lt;b&amp;gt;epoch&amp;lt;/b&amp;gt; and highlight detected peaks&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;plot_epoch_and_peak()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-101\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-42\&quot; y=\&quot;-120\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-106\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-101\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;65\&quot; y=\&quot;-130\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-115\&quot; value=\&quot;pinOut 1\&quot; style=\&quot;fontStyle=0;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;q_XP9tdPbFsaZTS1878Z-101\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;198\&quot; y=\&quot;-94.99999999999977\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-27\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;huTJLk3M8OtfZe6XO08h-6\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-26\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-28\&quot; value=\&quot;False\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-27\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-0.2923\&quot; y=\&quot;1\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint y=\&quot;1\&quot; as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-38\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;huTJLk3M8OtfZe6XO08h-6\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-36\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-39\&quot; value=\&quot;True\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-38\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-0.0744\&quot; y=\&quot;2\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;huTJLk3M8OtfZe6XO08h-6\&quot; value=\&quot;Mean R wave is good?\&quot; style=\&quot;rhombus;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontColor=#000000;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-705.4999999999999\&quot; y=\&quot;-1940\&quot; width=\&quot;140\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Nbf0Tub4fTZDGGXtQ6uE-28\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.162;entryY=-0.012;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Helvetica;fontColor=#000000;\&quot; parent=\&quot;1\&quot; source=\&quot;Nbf0Tub4fTZDGGXtQ6uE-26\&quot; target=\&quot;zNMVAwUSSOP5G73fzrCB-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Nbf0Tub4fTZDGGXtQ6uE-26\&quot; value=\&quot;1\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-42\&quot; y=\&quot;-240\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;q_XP9tdPbFsaZTS1878Z-31\&quot; value=\&quot;Detect all ECG affected channels as channels with mean artifact higher than threshold:&amp;lt;br&amp;gt;&amp;amp;nbsp;&amp;lt;b&amp;gt;mean over all channels artifact&amp;lt;/b&amp;gt; * miltiplier set by user.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;find_affected_over_mean()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=top;rounded=1;absoluteArcSize=1;arcSize=60;dashed=1;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;horizontal=0;fillColor=none;dashPattern=12 12;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-1300\&quot; y=\&quot;-1150\&quot; width=\&quot;490\&quot; height=\&quot;870\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-1\&quot; value=\&quot;\&quot; style=\&quot;group;flipV=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-764\&quot; y=\&quot;-2290\&quot; width=\&quot;250\&quot; height=\&quot;101\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-2\&quot; value=\&quot;Choose the method of finding affected channels based on the presense and quality of ECG channel:&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;get_ECG_data_choose_method()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;9.8\&quot; width=\&quot;240.2\&quot; height=\&quot;89.78\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-4\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;112.7\&quot; y=\&quot;89.77777777777777\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-5\&quot; value=\&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;Options:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;- Channel present and good: correlation with ECG channel&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;span style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;- Channel present and bad: correlation with reconstructed&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;- Channel missing: correlation with reconstructed channel&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;- Use mean ECG artifact as threshold (currrently not used)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/span&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-281\&quot; y=\&quot;-2279\&quot; width=\&quot;330\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-7\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;q_XP9tdPbFsaZTS1878Z-10\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-2\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-8\&quot; value=\&quot;\&quot; style=\&quot;group;flipV=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-762\&quot; y=\&quot;-2154\&quot; width=\&quot;243\&quot; height=\&quot;145\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-9\&quot; value=\&quot;&amp;lt;div style=&amp;quot;line-height: 18px;&amp;quot;&amp;gt;&amp;lt;p style=&amp;quot;&amp;quot;&amp;gt;Calculate&amp;lt;b&amp;gt; mean Rwave&amp;lt;/b&amp;gt; based on either real ECG channel data or on reconstructed data (depends on the method used)&amp;lt;br&amp;gt;     and check if it has an R wave shape.&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;&amp;quot;&amp;gt;Plot mean Rwave if calculation succeeded&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;check_mean_wave()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-8\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;9.72\&quot; width=\&quot;233.28\&quot; height=\&quot;128.8888888888889\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-10\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-8\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;111.78\&quot; y=\&quot;128.8888888888889\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-11\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-4\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-9\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-20\&quot; value=\&quot;1\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-476\&quot; y=\&quot;-2109\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-24\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-20\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-510\&quot; y=\&quot;-2094\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-92\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-26\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-91\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-26\&quot; value=\&quot;\&quot; style=\&quot;shape=sumEllipse;perimeter=ellipsePerimeter;html=1;backgroundOutline=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-468\&quot; y=\&quot;-1915\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-29\&quot; value=\&quot;Options:&amp;amp;nbsp;&amp;lt;br&amp;gt;- &amp;quot;correlation&amp;quot; (Correalation with ECG channel):&amp;lt;br&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;calculate mean&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;of recorded ECG&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;- &amp;quot;correlation_reconstructed&amp;quot; (Correlation with reconstructed channel):&amp;lt;br&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;1) reconstruct ECG channel on base of magnetometers&amp;lt;br&amp;gt;2) calculate mean of reconstructed channel&amp;lt;/blockquote&amp;gt;&amp;amp;nbsp;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-270\&quot; y=\&quot;-2149\&quot; width=\&quot;390\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-35\&quot; value=\&quot;\&quot; style=\&quot;group;flipV=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-755\&quot; y=\&quot;-1800\&quot; width=\&quot;240\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-36\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;Create ECG epochs for all channels based on the recorded or reconstructed ECG channel&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div style=&amp;quot;line-height: 18px;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;mne.preprocessing.create_ecg_epochs()&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-35\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry width=\&quot;240.00000000000003\&quot; height=\&quot;88.89\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-37\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-35\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105.39999999999999\&quot; y=\&quot;88.88888888888889\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-40\&quot; value=\&quot;\&quot; style=\&quot;group;direction=west;flipH=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-754\&quot; y=\&quot;-1660\&quot; width=\&quot;250\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-41\&quot; value=\&quot;Visualise ECG artifacts on channels using MNE&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;plot_ecg_eog_mne&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;()&amp;lt;/font&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-40\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;10\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-42\&quot; value=\&quot;pinIn 2\&quot; style=\&quot;fontStyle=0;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;flipH=0;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-40\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;240\&quot; y=\&quot;35\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-43\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-40\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-44\&quot; value=\&quot;2\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-468\&quot; y=\&quot;-1625\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-45\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-37\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-43\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-46\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-42\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-44\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-47\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-755\&quot; y=\&quot;-1520\&quot; width=\&quot;235\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-48\&quot; value=\&quot;- Calculate mean ECG artifact for every channel,&amp;lt;br&amp;gt;- Calculate &amp;lt;b&amp;gt;&amp;lt;i&amp;gt;smoothed&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt; mean ECG artifact for every channel using Gaussian kernel,&amp;lt;br&amp;gt;- Assign lobe color code to each artifact data for&amp;amp;nbsp; plotting&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;calculate_artifacts_on_channels&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;()&amp;lt;/font&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-47\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;13\&quot; width=\&quot;235\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-49\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-47\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;102.8125\&quot; y=\&quot;133.00000000000003\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-50\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-47\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;102.8125\&quot; y=\&quot;2.5\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-51\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.584;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-37\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-50\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-610\&quot; y=\&quot;-1540\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-642\&quot; y=\&quot;-1680\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-800\&quot; y=\&quot;-1680\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-800\&quot; y=\&quot;-1540\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-635\&quot; y=\&quot;-1540\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-55\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.519;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-679.38\&quot; y=\&quot;-2340\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;-1036.62\&quot; y=\&quot;-1290\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-642\&quot; y=\&quot;-2180\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1037\&quot; y=\&quot;-2180\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-56\&quot; value=\&quot;Method: &amp;lt;br&amp;gt;threshold_mean&amp;lt;br&amp;gt;(currently not used)\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-55\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;0.2482\&quot; y=\&quot;-2\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;109\&quot; y=\&quot;-404\&quot; as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-57\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-440\&quot; y=\&quot;-1250\&quot; width=\&quot;240\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-59\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-57\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; y=\&quot;254\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-60\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-57\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; y=\&quot;124\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-1\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-57\&quot;&gt;\n          &lt;mxGeometry y=\&quot;-10\&quot; width=\&quot;240\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-2\&quot; value=\&quot;Align the mean epoch of ECG channel in time with the mean epochs of ECG artifacts found on channels.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;align_mean_rwave&amp;lt;i&amp;gt;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;()&amp;lt;/font&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; vertex=\&quot;1\&quot; parent=\&quot;Vyd6QX7pljOJEs3M_v04-1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;11\&quot; width=\&quot;240\&quot; height=\&quot;88\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-3\&quot; value=\&quot;pinOut 2\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;Vyd6QX7pljOJEs3M_v04-1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; y=\&quot;99\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-4\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;Vyd6QX7pljOJEs3M_v04-1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; y=\&quot;0.6666666666666665\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-6\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-57\&quot; source=\&quot;Vyd6QX7pljOJEs3M_v04-3\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-60\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-61\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;strokeColor=default;jumpStyle=arc;entryX=0.75;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-4\&quot; edge=\&quot;1\&quot; target=\&quot;Vyd6QX7pljOJEs3M_v04-4\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-308\&quot; y=\&quot;-1310\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;-615.5\&quot; y=\&quot;-2350\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-629\&quot; y=\&quot;-2180\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-312\&quot; y=\&quot;-2180\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-62\&quot; value=\&quot;Methods:&amp;lt;br&amp;gt;correlation&amp;lt;br&amp;gt;&amp;amp;amp;&amp;lt;br&amp;gt;correlation_reconstructed\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-61\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;0.2229\&quot; y=\&quot;1\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-101\&quot; y=\&quot;-407\&quot; as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-63\&quot; value=\&quot;\&quot; style=\&quot;group;flipH=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-440\&quot; y=\&quot;-925\&quot; width=\&quot;250\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-64\&quot; value=\&quot;Plot artifact data of each channel sorted by their correlation coefficient&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;i&amp;gt;&amp;lt;b&amp;gt;plot_artif_per_ch_correlated_lobes&amp;lt;/b&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;()&amp;lt;/font&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-63\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;10\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-65\&quot; value=\&quot;pinIn 2\&quot; style=\&quot;fontStyle=0;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;flipH=0;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-63\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;240\&quot; y=\&quot;35\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-66\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-63\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-67\&quot; value=\&quot;3\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-140\&quot; y=\&quot;-890\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-68\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-65\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-67\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-69\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-59\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-66\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-70\&quot; value=\&quot;\&quot; style=\&quot;group;flipH=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-440\&quot; y=\&quot;-805\&quot; width=\&quot;250\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-71\&quot; value=\&quot;Plot correlation coefficient and p values for each channel&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;i style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;plot_correlation&amp;lt;/b&amp;gt;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b&amp;gt;()&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/i&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-70\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry y=\&quot;10\&quot; width=\&quot;240\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-72\&quot; value=\&quot;pinIn 2\&quot; style=\&quot;fontStyle=0;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;flipH=0;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-70\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;240\&quot; y=\&quot;35\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-73\&quot; value=\&quot;pinIn 1\&quot; style=\&quot;fontStyle=0;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=2;fontFamily=Helvetica;fontSize=12;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;ua0UwOFp4txvmiH0tm5q-70\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;105\&quot; width=\&quot;30\&quot; height=\&quot;10\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-74\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-310\&quot; y=\&quot;-986\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-310\&quot; y=\&quot;-950\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-80\&quot; y=\&quot;-950\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-80\&quot; y=\&quot;-825\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-320\&quot; y=\&quot;-825\&quot; /&gt;\n            &lt;/Array&gt;\n            &lt;mxPoint x=\&quot;-312.5\&quot; y=\&quot;-986\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;-320\&quot; y=\&quot;-805\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-75\&quot; value=\&quot;4\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-140\&quot; y=\&quot;-770\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-76\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-72\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-75\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-81\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-59\&quot; edge=\&quot;1\&quot; target=\&quot;ua0UwOFp4txvmiH0tm5q-78\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-327\&quot; y=\&quot;-970\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;-601\&quot; y=\&quot;-240\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-327\&quot; y=\&quot;-950\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-500\&quot; y=\&quot;-950\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-500\&quot; y=\&quot;-220\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-601\&quot; y=\&quot;-220\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-87\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.848;entryY=0.012;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-82\&quot; target=\&quot;zNMVAwUSSOP5G73fzrCB-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-82\&quot; value=\&quot;4\&quot; style=\&quot;ellipse;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;94\&quot; y=\&quot;-240\&quot; width=\&quot;30\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-91\&quot; value=\&quot;Output:&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;List of QC derivatives (fig)&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Empty dict as Simple metric&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;Str about no ECG artifacts detected\&quot; style=\&quot;html=1;dashed=0;fontFamily=Helvetica;fontSize=12;fontColor=rgb(0, 0, 0);align=center;strokeColor=rgb(0, 0, 0);fillColor=rgb(255, 255, 255);\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-60\&quot; y=\&quot;-1941\&quot; width=\&quot;198\&quot; height=\&quot;81\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-97\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.278;entryY=0.003;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-93\&quot; target=\&quot;jzh1gqENJoQ-7TW8aTZ5-13\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-98\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-49\&quot; target=\&quot;q_XP9tdPbFsaZTS1878Z-46\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-642\&quot; y=\&quot;-1350\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-1030\&quot; y=\&quot;-1350\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-99\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-49\&quot; target=\&quot;Vyd6QX7pljOJEs3M_v04-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-628\&quot; y=\&quot;-1377\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-628\&quot; y=\&quot;-1350\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-327\&quot; y=\&quot;-1350\&quot; /&gt;\n            &lt;/Array&gt;\n            &lt;mxPoint x=\&quot;-330\&quot; y=\&quot;-1310\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-100\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;jumpStyle=arc;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-10\&quot; target=\&quot;Vyd6QX7pljOJEs3M_v04-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-629\&quot; y=\&quot;-2015\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-629\&quot; y=\&quot;-1970\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-320\&quot; y=\&quot;-1970\&quot; /&gt;\n            &lt;/Array&gt;\n            &lt;mxPoint x=\&quot;-320\&quot; y=\&quot;-1310\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TA8RBadlavMFpg_JwYuW-1\&quot; value=\&quot;pinIn 2\&quot; style=\&quot;fontStyle=0;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;spacingLeft=2;fontFamily=Helvetica;fontSize=12;flipH=0;resizable=0;container=0;noLabel=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-520\&quot; y=\&quot;-2109\&quot; width=\&quot;10\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TA8RBadlavMFpg_JwYuW-2\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;ua0UwOFp4txvmiH0tm5q-10\&quot; target=\&quot;huTJLk3M8OtfZe6XO08h-6\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;-635\&quot; y=\&quot;-2015\&quot; /&gt;\n              &lt;mxPoint x=\&quot;-635\&quot; y=\&quot;-1980\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;ua0UwOFp4txvmiH0tm5q-58\&quot; value=\&quot;Use Pearson correlation of &amp;lt;b&amp;gt;mean Rwave&amp;lt;/b&amp;gt; with the artifact data of each channel to find correlation coefficient for each channel. Higher correlation -&amp;amp;gt; channel is more affected by ECG artifact&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;find_affected_by_correlation&amp;lt;i&amp;gt;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;()&amp;lt;/font&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;\&quot; style=\&quot;html=1;align=center;verticalAlign=middle;rounded=1;absoluteArcSize=1;arcSize=25;dashed=0;fontFamily=Helvetica;fontSize=12;whiteSpace=wrap;container=0;noLabel=0;imageAlign=center;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-440\&quot; y=\&quot;-1116\&quot; width=\&quot;240\&quot; height=\&quot;119.99999999999999\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-9\&quot; value=\&quot;For all possible ECG alignment variations:\&quot; style=\&quot;shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;recursiveResize=0;container=1;collapsible=0;width=160;dashed=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-470\&quot; y=\&quot;-1320\&quot; width=\&quot;310\&quot; height=\&quot;350\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Vyd6QX7pljOJEs3M_v04-10\&quot; value=\&quot;Alignment is performed multiple times (ca. 2-4) &amp;lt;br&amp;gt;and correlation is calculated every time. &amp;lt;br&amp;gt;The final alignment is the one resulting &amp;lt;br&amp;gt;in the highest correlation.\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-150\&quot; y=\&quot;-1186\&quot; width=\&quot;270\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n      &lt;/root&gt;\n    &lt;/mxGraphModel&gt;\n  &lt;/diagram&gt;\n&lt;/mxfile&gt;\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>
</body>
</html>